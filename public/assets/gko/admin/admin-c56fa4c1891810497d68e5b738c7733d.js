var shiftHeld=!1,body,loader,dialog_max_width=964,comfirm_dialog;$(document).ready(function(){body=$("body"),body.on("ajax:beforeSend","a[data-remote], form[data-remote]",function(){attachLoading("body")}).on("ajax:complete",function(){removeLoading("body")}).on("click","a.remove_fields",function(){return $(this).prev("input[type=hidden]").val("1"),$(this).closest(".fields").hide(),!1}).on("change",".observe_field",function(){target=$(this).attr("data-update"),ajax_indicator=$(this).attr("data-ajax-indicator")||"#busy_indicator",$(target).hide(),$(ajax_indicator).show(),$.ajax({dataType:"html",url:$(this).attr("data-base-url")+encodeURIComponent($(this).val()),type:"get",success:function(t){$(target).html(t),$(ajax_indicator).hide(),$(target).show()}})}),add_fields=function(t,o,e){var a=(new Date).getTime(),i=new RegExp("new_"+o,"g");$(t).append(e.replace(i,a)),$("input.color-field").each(function(){$(this).css("backgroundColor",$(this).attr("value")).colorpicker().on("changeColor",function(t){$(this).css("backgroundColor",t.color.toHex())})})},$.rails.allowAction=function(t){var o=t.data("confirm"),e=!1;return o?($.rails.fire(t,"confirm")&&(bootbox.setIcons({CONFIRM:"icon-trash icon-white"}),bootbox.confirm(o,"Non annuler","Oui supprimer",function(o){if(o){$.rails.fire(t,"confirm:complete",[e]);var a=$.rails.allowAction;$.rails.allowAction=function(){return!0},t.trigger("click"),$.rails.allowAction=a}bootbox.setIcons(null)})),!1):!0},parent&&parent.document.location.href!=document.location.href&&$("body#dialog_container.dialog").addClass("iframed"),$("ul.wym_tools a, li.wym_tools_class a:first").each(function(){$(this).attr("rel","tooltip").html("")}),$('a[rel="tooltip"], a[rel="tooltip nofollow"]').tooltip(),$('input[rel="popover"]').popover(),$(".btn.toggle").on("click",function(t){t.preventDefault(),$($(this).attr("href")).toggle()}),$.datepicker.setDefaults($.datepicker.regional.fr),$("input.date_picker, input.date, input.datetime").datepicker({dateFormat:"DD d MM yy"}),init_text_editor(),init_modal_dialogs(),init_images(),init_videos(),$("select[data-dynamic-selectable-url][data-dynamic-selectable-target]").dynamicSelectable(),$("textarea.wysihtml5").wysihtml5({stylesheets:"/assets/gko_wysihtml5_body.css"}),$("input.color-field").each(function(){$(this).css("backgroundColor",$(this).attr("value")).colorpicker().on("changeColor",function(t){$(this).css("backgroundColor",t.color.toHex())})})}),close_dialog=function(t){iframed()?(the_body=$(parent.document.body),the_dialog=parent.$(".ui-dialog-content")):(the_body=$(document.body).removeClass("hide-overflow"),the_dialog=$(".ui-dialog-content"),the_dialog.filter(":data(dialog)").dialog("close"),the_dialog.remove()),$(document.body).hasClass("wym_iframe_body")||(the_body.removeClass("hide-overflow"),the_dialog.filter(":data(dialog)").dialog("close"),the_dialog.remove(),t.preventDefault())};